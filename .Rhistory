clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(Rawlings.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "Rawlings")
Rawlings.mean.cloneResolved = aggregate(data = results, count~cloneResolved, mean)
lapply(Rawlings.IGH, names)
Rawlings.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/RawlingsJEM2015", columns = "all")
results = data.frame()
i = 1
for(i in 1:length(Rawlings.IGH)){
file = Rawlings.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(Rawlings.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "Rawlings")
Rawlings.mean.cloneResolved = aggregate(data = results, count~cloneResolved, mean)
write.csv(Rawlings.mean.cloneResolved, file = "Rawlings mean count by clone resolved IGH.csv")
Rawlings.mean.cloneResolved
Transplant.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/RawlingsJEM2015", columns = "all")
results = data.frame()
i = 1
for(i in 1:length(Transplant.IGH)){
file = Transplant.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(Transplant.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "Post-transplant")
Transplant.mean.cloneResolved = aggregate(data = results, count~cloneResolved, mean)
library(LymphoSeq)
library(ggplot2)
library(plyr)
setwd("~/Dropbox/Research/Projects/Burkitts/ImmunoSEQ/DJ analysis")
UCI.metadata = read.csv(file = "~/Dropbox/Research/Projects/Burkitts/ImmunoSEQ/UCI metadata.csv")
included.IGH = gsub(as.character(UCI.metadata[UCI.metadata$included == "Yes" & UCI.metadata$locus == "IGH", "fileName"]), pattern = ".tsv", replacement = "")
UCI.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/BurkittUCI", columns = "all")
UCI.IGH = UCI.IGH[included.IGH]
names(UCI.IGH) = as.character(UCI.metadata[match(names(UCI.IGH), gsub(UCI.metadata$fileName, pattern = ".tsv", replacement = "")),"tumorID"])
Ghana.metadata = read.csv(file = "~/Dropbox/Research/Projects/Burkitts/ImmunoSEQ/Ghana metadata.csv")
Ghana.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/BurkittGhana", columns = "all")
names(Ghana.IGH) = as.character(Ghana.metadata[match(names(Ghana.IGH), gsub(Ghana.metadata$fileName, pattern = ".tsv", replacement = "")),"tumorID"])
results = data.frame()
i = 1
for(i in 1:length(UCI.IGH)){
file = UCI.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(UCI.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "UCI")
ggsave("UCI frequency clone resolved IGH.png")
UCI.mean.cloneResolved = aggregate(data = results, count~cloneResolved, mean)
write.csv(mean, file = "UCI mean count by clone resolved IGH.csv")
Ghana.metadata = read.csv(file = "~/Dropbox/Research/Projects/Burkitts/ImmunoSEQ/Ghana metadata.csv")
Ghana.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/BurkittGhana", columns = "all")
names(Ghana.IGH) = as.character(Ghana.metadata[match(names(Ghana.IGH), gsub(Ghana.metadata$fileName, pattern = ".tsv", replacement = "")),"tumorID"])
results = data.frame()
i = 1
for(i in 1:length(Ghana.IGH)){
file = Ghana.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(Ghana.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "Ghana")
ggsave("Ghana frequency clone resolved IGH.png")
Ghana.mean.cloneResolved = aggregate(data = results, count~cloneResolved, mean)
write.csv(Ghana.mean.cloneResolved, file = "Ghana mean count by clone resolved IGH.csv")
Rawlings.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/RawlingsJEM2015", columns = "all")
results = data.frame()
i = 1
for(i in 1:length(Rawlings.IGH)){
file = Rawlings.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(Rawlings.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "Rawlings")
ggsave("Rawlings frequency clone resolved IGH.png")
Rawlings.mean.cloneResolved = aggregate(data = results, count~cloneResolved, mean)
write.csv(Rawlings.mean.cloneResolved, file = "Rawlings mean count by clone resolved IGH.csv")
Transplant.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/RawlingsJEM2015", columns = "all")
results = data.frame()
i = 1
for(i in 1:length(Transplant.IGH)){
file = Transplant.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(Transplant.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "2270")
ggsave("2270 frequency clone resolved IGH.png")
Transplant.mean.cloneResolved = aggregate(data = results, count~cloneResolved, mean)
write.csv(Transplant.mean.cloneResolved, file = "2270 mean count by clone resolved IGH.csv")
results = data.frame()
i = 1
for(i in 1:length(Ghana.IGH)){
file = Ghana.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(Ghana.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "Ghana")
ggsave("Ghana frequency clone resolved IGH.png", height = 7, width = 8, dpi = 300)
results = data.frame()
i = 1
for(i in 1:length(Ghana.IGH)){
file = Ghana.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(Ghana.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "Ghana")
ggsave("Ghana frequency clone resolved IGH.png", height = 6, width = 9, dpi = 300)
results = data.frame()
i = 1
for(i in 1:length(Rawlings.IGH)){
file = Rawlings.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(Rawlings.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "Rawlings")
ggsave("Rawlings frequency clone resolved IGH.png", height = 6, width = 9, dpi = 300)
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "Rawlings")
ggsave("Rawlings frequency clone resolved IGH.png", height = 8, width = 9, dpi = 300)
results = data.frame()
i = 1
for(i in 1:length(Transplant.IGH)){
file = Transplant.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(Transplant.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "2270")
ggsave("2270 frequency clone resolved IGH.png", height = 6, width = 9, dpi = 300)
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "2270")
ggsave("2270 frequency clone resolved IGH.png", height = 8, width = 9, dpi = 300)
results = data.frame()
i = 1
for(i in 1:length(UCI.IGH)){
file = UCI.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(UCI.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "UCI")
ggsave("UCI frequency clone resolved IGH.png")
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "UCI")
results = data.frame()
i = 1
for(i in 1:length(UCI.IGH)){
file = UCI.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(UCI.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
UCI.metadata = read.csv(file = "~/Dropbox/Research/Projects/Burkitts/ImmunoSEQ/UCI metadata.csv")
included.IGH = gsub(as.character(UCI.metadata[UCI.metadata$included == "Yes" & UCI.metadata$locus == "IGH", "fileName"]), pattern = ".tsv", replacement = "")
UCI.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/BurkittUCI", columns = "all")
UCI.IGH = UCI.IGH[included.IGH]
names(UCI.IGH) = as.character(UCI.metadata[match(names(UCI.IGH), gsub(UCI.metadata$fileName, pattern = ".tsv", replacement = "")),"tumorID"])
results = data.frame()
i = 1
for(i in 1:length(UCI.IGH)){
file = UCI.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(UCI.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
names(UCI.IGH)
match(names(UCI.IGH), UCI.metadata)
UCI.metadata$fileName)
UCI.metadata$fileName
as.character(UCI.metadata[match(names(UCI.IGH), as.character(UCI.metadata$fileName)),"tumorID"])
as.character(UCI.metadata$fileName)
match(names(UCI.IGH), as.character(UCI.metadata$fileName))
names(UCI.IGH)
UCI.metadata = read.csv(file = "~/Dropbox/Research/Projects/Burkitts/ImmunoSEQ/UCI metadata.csv")
included.IGH = gsub(as.character(UCI.metadata[UCI.metadata$included == "Yes" & UCI.metadata$locus == "IGH", "fileName"]), pattern = ".tsv", replacement = "")
UCI.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/BurkittUCI", columns = "all")
UCI.IGH = UCI.IGH[included.IGH]
as.character(UCI.metadata[match(names(UCI.IGH), as.character(UCI.metadata$fileName)),"tumorID"])
names(UCI.IGH)
as.character(UCI.metadata[UCI.metadata$included == "Yes" & UCI.metadata$locus == "IGH", "fileName"])
UCI.metadata$included
UCI.metadata[UCI.metadata$included == "Yes" & UCI.metadata$locus == "IGH", "fileName"]
UCI.metadata
UCI.metadata[UCI.metadata$included == "Yes" & UCI.metadata$locus == "IGH", "fileName"]
UCI.metadata$included == "Yes" & UCI.metadata$locus == "IGH"
UCI.metadata = read.csv(file = "~/Dropbox/Research/Projects/Burkitts/ImmunoSEQ/UCI metadata.csv")
as.character(UCI.metadata[UCI.metadata$included == "Yes" & UCI.metadata$locus == "IGH", "fileName"])
UCI.metadata$included
UCI.metadata$locus
as.character(UCI.metadata[UCI.metadata$included == "Yes" & UCI.metadata$Locus == "IGH", "fileName"])
included.IGH = as.character(UCI.metadata[UCI.metadata$included == "Yes" & UCI.metadata$Locus == "IGH", "fileName"])
UCI.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/BurkittUCI", columns = "all")
UCI.IGH = UCI.IGH[included.IGH]
names(UCI.IGH) = as.character(UCI.metadata[match(names(UCI.IGH), as.character(UCI.metadata$fileName)),"tumorID"])
results = data.frame()
i = 1
for(i in 1:length(UCI.IGH)){
file = UCI.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(UCI.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "UCI")
ggsave("UCI frequency clone resolved IGH.png")
Transplant.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/JHU 0844 - FHCRC 2270/IGH", columns = "all")
results = data.frame()
i = 1
for(i in 1:length(Transplant.IGH)){
file = Transplant.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(Transplant.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "2270")
Transplant.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/postTransplantCy/", columns = "all")
results = data.frame()
i = 1
for(i in 1:length(Transplant.IGH)){
file = Transplant.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(Transplant.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "2270")
lapply(Transplant.IGH, names)
Transplant.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/postTransplantCy/", columns = "c("count","cloneResolved"))
Transplant.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/postTransplantCy/", columns = c("count","cloneResolved"))
Transplant.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/postTransplantCy/", columns = c("count","count (reads)", "cloneResolved"))
?readImmunoSeq
Transplant.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/postTransplantCy/", columns = c("count","count (reads)", "count (templates)", "cloneResolved"))
Transplant.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/postTransplantCy/", columns = c("count", "count (reads)", "count (templates)", "cloneResolved"))
Transplant.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/postTransplantCy/", columns = "all")
Transplant.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/postTransplantCy/")
Transplant.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/postTransplantCy/", columns = "all")
Transplant.IGH = readImmunoSeq(path = "/Volumes/home/Warren_NGS/ImmunoSEQ/IGH/postTransplantCy/", columns = "all")
results = data.frame()
i = 1
for(i in 1:length(Transplant.IGH)){
file = Transplant.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(Transplant.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "2270")
results = data.frame()
i = 1
for(i in 1:length(Transplant.IGH)){
file = Transplant.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(Transplant.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "2270")
ggsave("2270 frequency clone resolved IGH.png", height = 8, width = 9, dpi = 300)
Transplant.mean.cloneResolved = aggregate(data = results, count~cloneResolved, mean)
write.csv(Transplant.mean.cloneResolved, file = "2270 mean count by clone resolved IGH.csv")
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
library(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
results = data.frame()
i = 1
for(i in 1:length(UCI.IGH)){
file = UCI.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(UCI.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
a=ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "UCI")
results = data.frame()
i = 1
for(i in 1:length(Ghana.IGH)){
file = Ghana.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(Ghana.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
b=ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "Ghana")
results = data.frame()
i = 1
for(i in 1:length(Rawlings.IGH)){
file = Rawlings.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(Rawlings.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
c=ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "Rawlings")
results = data.frame()
i = 1
for(i in 1:length(Transplant.IGH)){
file = Transplant.IGH[[i]]
clone = aggregate(data = file, count~cloneResolved, FUN = sum)
clone$count = clone$count/sum(file$count)*100
clone$sample = rep(names(Transplant.IGH[i]), nrow(clone))
results = rbind(clone, results)
}
d=ggplot(results, aes(x = sample, fill = cloneResolved, y = count)) +
geom_bar(stat = "identity") +
theme_classic() +
scale_fill_brewer(palette="Set1") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(x = "", y = "% Reads", title = "2270")
multiplot(a, b, c, d, cols=2)
multiplot(b, c, a, d, cols=2)
ggsave("multiplot", height = 16, width = 9)
ggsave("multiplot.png", height = 16, width = 9)
png(file ="Multiplot.png", res = 300, units = "in", height = 12, width = 9)
multiplot(b, c, a, d, cols=2)
dev.off()
png(file ="Multiplot.png", res = 300, units = "in", height = 12, width = 18)
multiplot(b, c, a, d, cols=2)
dev.off()
?spread
?spread
library(tidyr)
?spread
x = read.csv(file.choose())
library(dplyr)
spread(x, row, column)
View(x)
spread(x, Row, Column)
spread(x, Peptide, Value)
spread(x, Row, Column)
spread(x, Column)
spread(x, Column)
View(x)
spread(x, Column)
spread(x, Column)
View(x)
separate(x, column)
separate(x, Column)
separate(x, Row)
spread(x, Column)
x
spread(x, Column)
spread(x, Row)
spread(x, Value, Column)
?cast
cast(x, Row~Column)
library(reshape)
cast(x, Row~Column)
x = read.csv(file.choose())
matrix = cast(x, Row ~ Column)
matrix
